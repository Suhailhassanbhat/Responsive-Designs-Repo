{"version":3,"sources":["scripts/chart-02.js"],"names":["margin","top","left","right","bottom","height","width","svg","d3","select","append","attr","xPositionScale","scaleLinear","domain","range","yPositionScale","scaleBand","padding","csv","require","then","ready","catch","err","console","log","datapoints","sort","a","b","pct_women","instruments","map","d","instrument","selectAll","data","enter","bandwidth","labels","text","yAxis","axisLeft","tickSize","tickFormat","call","xAxis","axisTop","tickValues","lower","render","svgContainer","node","closest","svgWidth","offsetWidth","svgHeight","window","innerHeight","actualSvg","newWidth","newHeight","addEventListener"],"mappings":"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","file":"chart-02.92076419.js","sourceRoot":"../src","sourcesContent":["import * as d3 from 'd3'\n\nconst margin = { top: 50, left: 125, right: 20, bottom: 50 }\n\nconst height = 600 - margin.top - margin.bottom\nconst width = 450 - margin.left - margin.right\n\nconst svg = d3\n  .select('#chart-02')\n  .append('svg')\n  .attr('height', height + margin.top + margin.bottom)\n  .attr('width', width + margin.left + margin.right)\n  .append('g')\n  .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n\nconst xPositionScale = d3\n  .scaleLinear()\n  .domain([0, 100])\n  .range([0, width])\n\nconst yPositionScale = d3\n  .scaleBand()\n  .range([height, 0])\n  .padding(0.25)\n\nd3.csv(require('../data/orchestras.csv'))\n  .then(ready)\n  .catch(err => console.log('Failed on', err))\n\nfunction ready(datapoints) {\n  // Extract the year from the date column\n  // Make sure points is a number\n\n  datapoints.sort((a, b) => a.pct_women - b.pct_women)\n\n  const instruments = datapoints.map(d => d.instrument)\n  yPositionScale.domain(instruments)\n\n  svg\n    .selectAll('.instrument-bg')\n    .data(datapoints)\n    .enter()\n    .append('rect')\n    .attr('class', 'instrument-bg')\n    .attr('y', d => yPositionScale(d.instrument))\n    .attr('x', 0)\n    .attr('height', yPositionScale.bandwidth())\n    .attr('width', width)\n    .attr('fill', '#999999')\n\n  svg\n    .selectAll('.instrument')\n    .data(datapoints)\n    .enter()\n    .append('rect')\n    .attr('class', 'instrument')\n    .attr('y', d => yPositionScale(d.instrument))\n    .attr('x', 0)\n    .attr('height', yPositionScale.bandwidth())\n    .attr('width', d => xPositionScale(d.pct_women))\n    .attr('fill', '#67bea2')\n\n  const labels = ['Men', 'Women']\n\n  svg\n    .selectAll('.gender-label')\n    .data(labels)\n    .enter()\n    .append('text')\n    .attr('class', 'gender-label')\n    .attr('y', yPositionScale('Flute'))\n    .attr('x', function(d) {\n      if (d === 'Men') {\n        return xPositionScale(80)\n      } else {\n        return xPositionScale(20)\n      }\n    })\n    .attr('text-anchor', 'middle')\n    .attr('fill', 'white')\n    .attr('alignment-baseline', 'middle')\n    .attr('dy', yPositionScale.bandwidth() / 2)\n    .text(d => d)\n\n  svg\n    .append('line')\n    .attr('class', 'halfway-line')\n    .attr('x1', xPositionScale(50))\n    .attr('y1', 0)\n    .attr('x2', xPositionScale(50))\n    .attr('y2', height)\n    .attr('stroke', 'white')\n    .attr('stroke-width', 2)\n\n  const yAxis = d3\n    .axisLeft(yPositionScale)\n    .tickSize(0)\n    .tickFormat(d => d)\n\n  svg\n    .append('g')\n    .attr('class', 'axis y-axis')\n    .call(yAxis)\n\n  svg\n    .selectAll('.y-axis text')\n    .attr('fill', d => {\n      if (d === 'Harp' || d == 'Flute' || d == 'Violin') {\n        return '#67bea2'\n      } else {\n        return '#999999'\n      }\n    })\n    .attr('dx', -10)\n\n  const xAxis = d3\n    .axisTop(xPositionScale)\n    .tickValues([20, 40, 60, 80])\n    .tickFormat(d => d + '%')\n    .tickSize(-height)\n\n  svg\n    .append('g')\n    .attr('class', 'axis x-axis')\n    .call(xAxis)\n    .lower()\n\n  svg.selectAll('.axis line').attr('stroke', '#ccc')\n  svg.selectAll('.axis path').attr('stroke', 'none')\n\n  svg.selectAll('.axis text').attr('font-size', 18)\n  svg.selectAll('.x-axis text').attr('fill', '#999999')\n\n  function render() {\n    // Grabbing the div that our svg is inside of\n    // and asking it wide it is\n    // \"hey <svg> that is really a <g>, go through\n    // your parents until you find a div\"\n    const svgContainer = svg.node().closest('div')\n    const svgWidth = svgContainer.offsetWidth\n    const svgHeight = window.innerHeight\n    // If you don't want the height to change, use this\n    // const newHeight = height + margin.top + margin.bottom\n\n    // Update the height of our SVG with svgHeight\n    // Create a newHeight variable using svgHeight\n    // Use the newHeight variabe to update our yPositionScale\n    // Reposition the y position of our rectangles using the yPositionScale\n    // Update the height of our rectangles\n\n    console.log(svgWidth)\n\n    // .node() means \"no really give me the HTML element,\n    //    not the weird d3 representation\"\n    // .parentNode means \"give me the svg that's outside\n    //    of the g,\" which we can actually change\n    //    the size of with .attr\n    // .closest('svg') means \"go through your parents until\n    //   you find an svg, in case we have a g in a g in a g\"\n    const actualSvg = d3.select(svg.node().closest('svg'))\n    actualSvg.attr('width', svgWidth).attr('height', svgHeight)\n\n    // Remember how we do\n    //    var width = 700 - margin.left - margin.right?\n    // this is the same thing, since svgWidth is the FULL\n    // SIZE of the svg, not the drawing area (the g)\n    const newWidth = svgWidth - margin.left - margin.right\n    const newHeight = svgHeight - margin.top - margin.bottom\n    // If you don't want the height to change, use this\n    // const newHeight = height + margin.top + margin.bottom\n\n    // Update our axes\n    // First, update the scale\n    // Then, update the axis\n    xPositionScale.range([0, newWidth])\n    yPositionScale.range([newHeight, 0])\n\n    svg.select('.x-axis').call(xAxis)\n    svg.select('.y-axis').call(yAxis)\n\n    // Find everything that needs to be updated\n    // like widths\n    // and update them!\n    svg\n      .selectAll('.instrument')\n      .attr('width', d => xPositionScale(d.pct_women))\n      .attr('height', yPositionScale.bandwidth())\n      .attr('y', d => yPositionScale(d.instrument))\n\n    svg\n      .selectAll('.instrument-bg')\n      .attr('width', newWidth)\n      .attr('height', yPositionScale.bandwidth())\n      .attr('y', d => yPositionScale(d.instrument))\n\n    // Update the midpoint line\n    svg\n      .select('.halfway-line')\n      .attr('x1', xPositionScale(50))\n      .attr('y1', 0)\n      .attr('x2', xPositionScale(50))\n      .attr('y2', newHeight)\n\n    if (newHeight < 500) {\n      svg.selectAll('text').attr('font-size', 12)\n    } else {\n      svg.selectAll('text').attr('font-size', 14)\n    }\n\n    // Put the gender labels where they went before\n    svg\n      .selectAll('.gender-label')\n      .attr('y', yPositionScale('Flute'))\n      .attr('dy', yPositionScale.bandwidth() / 2)\n      .attr('x', function(d) {\n        if (d === 'Men') {\n          return xPositionScale(80)\n        } else {\n          return xPositionScale(20)\n        }\n      })\n  }\n\n  // When the window resizes, run the function\n  // that redraws everything\n  window.addEventListener('resize', render)\n\n  // And now that the page has loaded, let's just try\n  // to do it once before the page has resized\n  render()\n}\n"]}